# 速卖通API + 奇门 + 聚石塔 完整流程


速卖通申请:
1.申请应用

1.1成为开发者  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190128194842577.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
点击登录，注意：如果是申请商用软件开发，那么此处一定是要用企业支付宝来登录（我是申请商用软件，所以此处就不讲自研型）

1.2 登录成功之后点击控制台  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190128195142285.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
点击创建应用，由于我们公司是做电商的，所以我选择的是电商后台，大家可以根据自己的需要选择对应的应用

![在这里插入图片描述](https://img-blog.csdnimg.cn/20190128195318377.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
点击申请应用  
![在这里插入图片描述](https://img-blog.csdnimg.cn/201901281954450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
填入响应信息点击提交，等待审核  
1.3审核成功之后，创建应用，根据所需要的信息创建好之后，系统会分给我们对应的appKey，appSercet,创建好应用之后就可以对接接口，速卖通提供了SDK可以直接推荐使用，方便开发，注意：接口文档中的session就是access_token，使用sdk开发时，传入的参数url的值是http://gw.api.taobao.com/router/rest  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190128195711576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
1.4 接口完成对接之后，速卖通的接口就可以了，下来就是将代码部署到聚石塔


**2 聚石塔**

2.1 首先是聚石塔的购买,此处需要说明聚石塔就是服务器，只是换了名字  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129191652807.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129191806908.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
根据需求选择相应配置购买就可以了  
2.2 聚石塔购买成功后会跳转到下图所示页面  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129191954485.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
点击实例管理，就会进入如下图所示页面  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129192056918.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
2.3 接下来就是配置实例信息，第一次使用时，需要重置连接密码，请注意，这个连接密码不是登录服务器的密码，请不要搞错了，远程登录密码只在第一次登录时会用到，登录服务器的用户名密码是需要自己设置的，此处还有一点需要注意，因为我选择的系统是linux的，所以用户名是root，这个是官方规定的，直接用就可以了，点击重置实例密码，就可以修改密码了，还有一点需要注意，密码修改成功之后会提示重启，是重启服务器不是重启自己的电脑，重启服务器  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129192346127.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
重启服务器  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129192739763.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
2.4 设置好实例的密码之后，接下来就是在服务器上配置环境部署代码此处就不啰嗦了

**3.奇门**

3.1 使用奇门之前，需要先创建场景，奇门提供了官方场景和自定义场景，由于官方场景只有一部分，所以有些场景是需要自定义的，以获取类目信息为例，由于官方场景中没有集成类目这块，所以就需要我们选择自定义场景

![在这里插入图片描述](https://img-blog.csdnimg.cn/2019012919330386.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
场景名称和业务类型请根据需求来选择![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129193401224.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)

3.2 场景创建好了之后，下来就是创建API  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129193604223.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
此处有个注意的地方就是自定义参数名最好是设置成方法的传入参数名一致这样比较方便，如果不一致可以在下面的body中做映射

3.3 奇门和聚石塔接口映射，此处是个重点，奇门官方给出的linux系统下http请求的端口是80，这个是默认的，为了方便起见我自己代码中设置的端口也是80，下图所示的地址是请求聚石塔接口的地址，虽然代码部署到聚石塔就可以访问了，但是官方规定如果这个服务上线之后就必须通过奇门，所以奇门是必须要的，这个ip地址我用的是聚石塔的公网地址，配置好之后点击下一步  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129193839845.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
3.4 上面一步是设置请求参数，下来就是设置响应参数，请注意对象和列表类型的选择，这一步只需要设置这里就可以了，点击下一步  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129194837370.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
3.5 预览页面，可以看下配置的是否正确，如果没问题点进入到自测环境，没有问题的话就点上一步修改  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129194949269.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
3.6 API设置好了之后，下来就是测试页面的测试了，但是在设置之前，点击左边的授权配置，在页面中配置响应的信息  
![在这里插入图片描述](https://img-blog.csdnimg.cn/2019012919513488.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
3.7 授权配置好了之后就可以进行测试了，由于这个API还没有发布，所以是选择测试环境  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129195246483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
appSecret和AppKey就是之前创建应用成功之后系统分配的，如果报错说ip不在白名单，那么要在插入一个操作将ip添加到ip白名单  
![在这里插入图片描述](https://img-blog.csdnimg.cn/20190129195508755.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21pX2d1X25pYW5n,size_16,color_FFFFFF,t_70)  
这样就可以了，可以调通接口了

4,调用奇门，这个代码是需要自己完成的，就不啰嗦了